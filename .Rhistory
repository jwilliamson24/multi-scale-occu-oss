setwd("~/Library/CloudStorage/OneDrive-Personal/Documents/Academic/OSU/Git/multi-scale-occu-oss")
##### Setup --------------------------------------------
library(ggplot2)
library(dplyr)
library(patchwork)
# Load data
e_covs <- read.csv("data/enes.prepost.multiscale.occu.csv")
o_covs <- read.csv("data/oss.prepost.multiscale.occu.csv")
load("data/msc-enes-data-workspace.RData")
load("data/multiscale_output_and_data_072125_enes_small.RData")
E = a2
load("data/multiscale_output_and_data_072525_oss_small.RData")
O = a2
# Estimates
summary(E)
summary(O)
# Combine
E2 = runjags::combine.mcmc(E)
O2 = runjags::combine.mcmc(O)
summary_table <- summary(E) # # # # # choose species # # # # #
params_to_plot <- c("beta0.psi", "beta0.theta", "alpha0",
"beta1.psi.BU", "beta2.psi.HB", "beta3.psi.HU", "beta4.psi.BS",
"beta5.psi.lat", "beta6.psi.lon", "beta8.psi.elev",
"beta1.theta.DW", "alpha1", "alpha2")
# summarize
coef_df <- data.frame(
Parameter = rownames(summary_table$statistics),
Mean = summary_table$statistics[, "Mean"],
LCI = summary_table$quantiles[, "2.5%"],
UCI = summary_table$quantiles[, "97.5%"]
)
# subset parameters
coef_df <- subset(coef_df, Parameter %in% params_to_plot)
# add submodel column to group by
coef_df$Submodel <- case_when(
coef_df$Parameter %in% c("beta0.psi", "beta1.psi.BU", "beta2.psi.HB", "beta3.psi.HU", "beta4.psi.BS",
"beta5.psi.lat", "beta6.psi.lon", "beta8.psi.elev") ~ "Site Occupancy (ψ)",
coef_df$Parameter %in% c("beta0.theta", "beta1.theta.DW") ~ "Subplot Use (θ)",
coef_df$Parameter %in% c("alpha0", "alpha1", "alpha2") ~ "Detection (p)",
TRUE ~ "Other"
)
# order submodel groupings in plot
coef_df$Submodel <- factor(coef_df$Submodel, levels = c(
"Site Occupancy (ψ)",
"Subplot Use (θ)",
"Detection (p)"
))
# rename - optional
coef_df$Parameter <- recode(coef_df$Parameter,
"beta1.psi.BU" = "Burned (BU)",
"beta2.psi.HB" = "Harvest+Burn (HB)",
"beta3.psi.HU" = "Harvested (HU)",
"beta4.psi.BS" = "Burn+Salvage (BS)",
"beta0.psi" = "Site Occu Intercept",
"beta0.theta" = "Plot Use Intercept",
"alpha0" = "Detection Intercept",
"beta5.psi.lat" = "Latitude",
"beta6.psi.lon" = "Longitude",
"beta8.psi.elev" = "Elevation",
"beta1.theta.DW" = "Downed Wood",
"alpha1" = "Linear Temp",
"alpha2" = "Quadratic Temp")
p <- ggplot(coef_df, aes(x = Mean, y = reorder(Parameter, Mean))) +
geom_point() +
geom_errorbarh(aes(xmin = LCI, xmax = UCI), height = 0.2) +
geom_vline(xintercept = 0, linetype = "dashed") +
facet_wrap(~ Submodel, scales = "free_y", ncol=1) +
labs(title = "Posterior Coefficient Estimates - OSS",
x = "Estimate (logit scale)",
y = "Parameter") +
theme(
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 13),
axis.title.y = element_text(size = 13),
legend.position = "none",
strip.text = element_text(size = 13, face = "bold"),
plot.title = element_text(face = "bold")
)
p
p <- ggplot(coef_df, aes(x = Mean, y = reorder(Parameter, Mean))) +
geom_point() +
geom_errorbarh(aes(xmin = LCI, xmax = UCI), height = 0.2) +
geom_vline(xintercept = 0, linetype = "dashed") +
facet_wrap(~ Submodel, scales = "free_y", ncol=1) +
labs(title = "Posterior Coefficient Estimates - ENES",
x = "Estimate (logit scale)",
y = "Parameter") +
theme(
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 13),
axis.title.y = element_text(size = 13),
legend.position = "none",
strip.text = element_text(size = 13, face = "bold"),
plot.title = element_text(face = "bold")
p
p <- ggplot(coef_df, aes(x = Mean, y = reorder(Parameter, Mean))) +
geom_point() +
geom_errorbarh(aes(xmin = LCI, xmax = UCI), height = 0.2) +
geom_vline(xintercept = 0, linetype = "dashed") +
facet_wrap(~ Submodel, scales = "free_y", ncol=1) +
labs(title = "Posterior Coefficient Estimates - OSS",
x = "Estimate (logit scale)",
y = "Parameter") +
theme(
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 13),
axis.title.y = element_text(size = 13),
legend.position = "none",
strip.text = element_text(size = 13, face = "bold"),
plot.title = element_text(face = "bold")
)
p
p <- ggplot(coef_df, aes(x = Mean, y = reorder(Parameter, Mean))) +
geom_point() +
geom_errorbarh(aes(xmin = LCI, xmax = UCI), height = 0.2) +
geom_vline(xintercept = 0, linetype = "dashed") +
facet_wrap(~ Submodel, scales = "free_y", ncol=1) +
labs(title = "Posterior Coefficient Estimates - enes",
x = "Estimate (logit scale)",
y = "Parameter") +
theme(
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 13),
axis.title.y = element_text(size = 13),
legend.position = "none",
strip.text = element_text(size = 13, face = "bold"),
plot.title = element_text(face = "bold")
)
p <- ggplot(coef_df, aes(x = Mean, y = reorder(Parameter, Mean))) +
geom_point() +
geom_errorbarh(aes(xmin = LCI, xmax = UCI), height = 0.2) +
geom_vline(xintercept = 0, linetype = "dashed") +
facet_wrap(~ Submodel, scales = "free_y", ncol=1) +
labs(title = "Posterior Coefficient Estimates - ENES",
x = "Estimate (logit scale)",
y = "Parameter") +
theme(
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 13),
axis.title.y = element_text(size = 13),
legend.position = "none",
strip.text = element_text(size = 13, face = "bold"),
plot.title = element_text(face = "bold")
)
p
ggsave("figures/e-coeff-plot-renamed-params.png", plot = p, dpi = 300)
summary_table <- summary(O) # # # # # choose species # # # # #
params_to_plot <- c("beta0.psi", "beta0.theta", "alpha0",
"beta1.psi.BU", "beta2.psi.HB", "beta3.psi.HU", "beta4.psi.BS",
"beta5.psi.lat", "beta6.psi.lon", "beta8.psi.elev",
"beta1.theta.DW", "alpha1", "alpha2")
# summarize
coef_df <- data.frame(
Parameter = rownames(summary_table$statistics),
Mean = summary_table$statistics[, "Mean"],
LCI = summary_table$quantiles[, "2.5%"],
UCI = summary_table$quantiles[, "97.5%"]
)
# subset parameters
coef_df <- subset(coef_df, Parameter %in% params_to_plot)
# add submodel column to group by
coef_df$Submodel <- case_when(
coef_df$Parameter %in% c("beta0.psi", "beta1.psi.BU", "beta2.psi.HB", "beta3.psi.HU", "beta4.psi.BS",
"beta5.psi.lat", "beta6.psi.lon", "beta8.psi.elev") ~ "Site Occupancy (ψ)",
coef_df$Parameter %in% c("beta0.theta", "beta1.theta.DW") ~ "Subplot Use (θ)",
coef_df$Parameter %in% c("alpha0", "alpha1", "alpha2") ~ "Detection (p)",
TRUE ~ "Other"
)
# order submodel groupings in plot
coef_df$Submodel <- factor(coef_df$Submodel, levels = c(
"Site Occupancy (ψ)",
"Subplot Use (θ)",
"Detection (p)"
))
# rename - optional
coef_df$Parameter <- recode(coef_df$Parameter,
"beta1.psi.BU" = "Burned (BU)",
"beta2.psi.HB" = "Harvest+Burn (HB)",
"beta3.psi.HU" = "Harvested (HU)",
"beta4.psi.BS" = "Burn+Salvage (BS)",
"beta0.psi" = "Site Occu Intercept",
"beta0.theta" = "Plot Use Intercept",
"alpha0" = "Detection Intercept",
"beta5.psi.lat" = "Latitude",
"beta6.psi.lon" = "Longitude",
"beta8.psi.elev" = "Elevation",
"beta1.theta.DW" = "Downed Wood",
"alpha1" = "Linear Temp",
"alpha2" = "Quadratic Temp")
p <- ggplot(coef_df, aes(x = Mean, y = reorder(Parameter, Mean))) +
geom_point() +
geom_errorbarh(aes(xmin = LCI, xmax = UCI), height = 0.2) +
geom_vline(xintercept = 0, linetype = "dashed") +
facet_wrap(~ Submodel, scales = "free_y", ncol=1) +
labs(title = "Posterior Coefficient Estimates - OSS",
x = "Estimate (logit scale)",
y = "Parameter") +
theme(
axis.text.x = element_text(size = 12),
axis.text.y = element_text(size = 12),
axis.title.x = element_text(size = 13),
axis.title.y = element_text(size = 13),
legend.position = "none",
strip.text = element_text(size = 13, face = "bold"),
plot.title = element_text(face = "bold")
)
p
ggsave("figures/o-coeff-plot-renamed-params.png", plot = p, dpi = 300)
